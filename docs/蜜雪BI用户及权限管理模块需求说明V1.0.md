# 蜜雪BI用户及权限管理模块需求说明V1.0

## 使用角色

- **店员（employee）**: 填写各类收款明细及误差信息，上报营业额，上传相关凭证。支持分阶段录入信息。
- **分店长（branch_manager）**: 与店员功能一致，管理店铺日常运营和数据上报。支持分阶段录入信息。
- **总店长（head_manager）**: 可查看所有门店销售数据，辅助管理。
- **财务人员（finance）**: 核对上报数据与银行实际到账是否一致（线下比对），记录误差，决定是否需要门店补缴。
- **管理员（admin）**: 可查看全部门店销售数据，辅助管理。

### 权限分组

- **管理组 (Management Group)**
  - **包含角色**: `管理员 (ADMIN)`, `总店长 (HEAD_MANAGER)`, `财务人员 (FINANCE)`。
  - **核心权限**: 拥有**全局操作范围**。可以查看和操作**所有店铺**的数据。
- **门店组 (Store-level Group)**
  - **包含角色**: `分店长 (BRANCH_MANAGER)`, `店员 (EMPLOYEE)`。
  - **核心权限**: 拥有**受限操作范围**。仅能查看和操作**自己所属的唯一店铺**的数据。

| 功能模块     | 管理组的权限                                   | 门店组的权限                                                 |
| ------------ | :--------------------------------------------- | ------------------------------------------------------------ |
| 首页         | 查看所有门店的销售数据                         | 仅能查看自己所属门店的销售数据                               |
| 个人资料管理 | 可以管理(增、删、改)所有人的资料，包括重置密码 | 仅能管理自己的个人资料                                       |
| 员工档案管理 | 可以管理(增、删、改)所有的员工档案。           | 仅能“一次性”地创建自己的员工档案。档案创建后，无权自行修改，编辑入口按钮将将消失。 |

## 管理组用户管理功能

- 管理组可在“用户管理”页面查看所有用户，支持搜索、分页。
- 可点击任意用户查看详情，进行编辑、重置密码、删除等操作。
- 可新建任意角色用户，并分配门店。
- 所有操作均需二次确认，操作有日志记录。
- 普通门店组用户无权访问该功能。

### 典型功能页面
- 用户列表页：展示所有用户，支持搜索、分页、操作按钮（查看、编辑、删除、重置密码）。
- 用户详情页：展示用户所有信息。
- 用户编辑页：管理组可编辑任意用户的所有信息。
- 新建用户页：管理组可新建任意角色用户。
- 删除用户、重置密码：需二次确认。

### 路由建议
- /admin/users 用户列表
- /admin/users/<user_id> 用户详情
- /admin/users/<user_id>/edit 编辑用户
- /admin/users/<user_id>/delete 删除用户
- /admin/users/<user_id>/reset_password 重置密码
- /admin/users/create 新建用户

### 权限控制
- 仅限管理组访问，门店组无权访问。